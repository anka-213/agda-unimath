---
title: Univalent Mathematics in Agda
---

# The Fibonacci sequence

<pre class="Agda"><a id="81" class="Symbol">{-#</a> <a id="85" class="Keyword">OPTIONS</a> <a id="93" class="Pragma">--without-K</a> <a id="105" class="Pragma">--exact-split</a> <a id="119" class="Symbol">#-}</a>

<a id="124" class="Keyword">module</a> <a id="131" href="elementary-number-theory.fibonacci-sequence.html" class="Module">elementary-number-theory.fibonacci-sequence</a> <a id="175" class="Keyword">where</a>

<a id="182" class="Keyword">open</a> <a id="187" class="Keyword">import</a> <a id="194" href="elementary-number-theory.addition-natural-numbers.html" class="Module">elementary-number-theory.addition-natural-numbers</a> <a id="244" class="Keyword">using</a> <a id="250" class="Symbol">(</a><a id="251" href="elementary-number-theory.addition-natural-numbers.html#988" class="Function">add-ℕ</a><a id="256" class="Symbol">)</a>
<a id="258" class="Keyword">open</a> <a id="263" class="Keyword">import</a> <a id="270" href="elementary-number-theory.natural-numbers.html" class="Module">elementary-number-theory.natural-numbers</a> <a id="311" class="Keyword">using</a> <a id="317" class="Symbol">(</a><a id="318" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a><a id="319" class="Symbol">;</a> <a id="321" href="elementary-number-theory.natural-numbers.html#1478" class="InductiveConstructor">succ-ℕ</a><a id="327" class="Symbol">;</a> <a id="329" href="elementary-number-theory.natural-numbers.html#2497" class="Function">ind-ℕ</a><a id="334" class="Symbol">)</a>
</pre>
<pre class="Agda"><a id="Fibonacci-ℕ"></a><a id="349" href="elementary-number-theory.fibonacci-sequence.html#349" class="Function">Fibonacci-ℕ</a> <a id="361" class="Symbol">:</a> <a id="363" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="365" class="Symbol">→</a> <a id="367" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a>
<a id="369" href="elementary-number-theory.fibonacci-sequence.html#349" class="Function">Fibonacci-ℕ</a> <a id="381" class="Number">0</a> <a id="383" class="Symbol">=</a> <a id="385" class="Number">0</a>
<a id="387" href="elementary-number-theory.fibonacci-sequence.html#349" class="Function">Fibonacci-ℕ</a> <a id="399" class="Symbol">(</a><a id="400" href="elementary-number-theory.natural-numbers.html#1478" class="InductiveConstructor">succ-ℕ</a> <a id="407" class="Number">0</a><a id="408" class="Symbol">)</a> <a id="410" class="Symbol">=</a> <a id="412" class="Number">1</a>
<a id="414" href="elementary-number-theory.fibonacci-sequence.html#349" class="Function">Fibonacci-ℕ</a> <a id="426" class="Symbol">(</a><a id="427" href="elementary-number-theory.natural-numbers.html#1478" class="InductiveConstructor">succ-ℕ</a> <a id="434" class="Symbol">(</a><a id="435" href="elementary-number-theory.natural-numbers.html#1478" class="InductiveConstructor">succ-ℕ</a> <a id="442" href="elementary-number-theory.fibonacci-sequence.html#442" class="Bound">n</a><a id="443" class="Symbol">))</a> <a id="446" class="Symbol">=</a> <a id="448" href="elementary-number-theory.addition-natural-numbers.html#988" class="Function">add-ℕ</a> <a id="454" class="Symbol">(</a><a id="455" href="elementary-number-theory.fibonacci-sequence.html#349" class="Function">Fibonacci-ℕ</a> <a id="467" class="Symbol">(</a><a id="468" href="elementary-number-theory.natural-numbers.html#1478" class="InductiveConstructor">succ-ℕ</a> <a id="475" href="elementary-number-theory.fibonacci-sequence.html#442" class="Bound">n</a><a id="476" class="Symbol">))</a> <a id="479" class="Symbol">(</a><a id="480" href="elementary-number-theory.fibonacci-sequence.html#349" class="Function">Fibonacci-ℕ</a> <a id="492" href="elementary-number-theory.fibonacci-sequence.html#442" class="Bound">n</a><a id="493" class="Symbol">)</a>
</pre>
The above definition of the Fibonacci sequence uses Agda's powerful
pattern matching definitions. Below, we will give a definition of the
Fibonacci sequence in terms of `ind-ℕ`.

The problem with defining the Fibonacci sequence using `ind-ℕ`, is that `ind-ℕ`
doesn't give us a way to refer to both `(F n)` and `(F (succ-ℕ n))`. So, we have
to give a workaround, where we store two values in the Fibonacci sequence
at once.

The basic idea is that we define a sequence of pairs of integers, which will
be consecutive Fibonacci numbers. This would be a function of type $ℕ → ℕ²$.

Such a function is easy to give with induction, using the map $ℕ² → ℕ²$ that
takes a pair `(m,n)` to the pair `(n,n+m)`. Starting the iteration with `(0,1)`
we obtain the Fibonacci sequence by taking the first projection.

However, we haven't defined cartesian products or booleans yet. Therefore
we mimic the above idea, using $ℕ → ℕ$ instead of $ℕ²$.

<pre class="Agda"><a id="shift-one"></a><a id="1441" href="elementary-number-theory.fibonacci-sequence.html#1441" class="Function">shift-one</a> <a id="1451" class="Symbol">:</a> <a id="1453" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1455" class="Symbol">→</a> <a id="1457" class="Symbol">(</a><a id="1458" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1460" class="Symbol">→</a> <a id="1462" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a><a id="1463" class="Symbol">)</a> <a id="1465" class="Symbol">→</a> <a id="1467" class="Symbol">(</a><a id="1468" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1470" class="Symbol">→</a> <a id="1472" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a><a id="1473" class="Symbol">)</a>
<a id="1475" href="elementary-number-theory.fibonacci-sequence.html#1441" class="Function">shift-one</a> <a id="1485" href="elementary-number-theory.fibonacci-sequence.html#1485" class="Bound">n</a> <a id="1487" href="elementary-number-theory.fibonacci-sequence.html#1487" class="Bound">f</a> <a id="1489" class="Symbol">=</a> <a id="1491" href="elementary-number-theory.natural-numbers.html#2497" class="Function">ind-ℕ</a> <a id="1497" href="elementary-number-theory.fibonacci-sequence.html#1485" class="Bound">n</a> <a id="1499" class="Symbol">(λ</a> <a id="1502" href="elementary-number-theory.fibonacci-sequence.html#1502" class="Bound">x</a> <a id="1504" href="elementary-number-theory.fibonacci-sequence.html#1504" class="Bound">y</a> <a id="1506" class="Symbol">→</a> <a id="1508" href="elementary-number-theory.fibonacci-sequence.html#1487" class="Bound">f</a> <a id="1510" href="elementary-number-theory.fibonacci-sequence.html#1502" class="Bound">x</a><a id="1511" class="Symbol">)</a>

<a id="shift-two"></a><a id="1514" href="elementary-number-theory.fibonacci-sequence.html#1514" class="Function">shift-two</a> <a id="1524" class="Symbol">:</a> <a id="1526" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1528" class="Symbol">→</a> <a id="1530" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1532" class="Symbol">→</a> <a id="1534" class="Symbol">(</a><a id="1535" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1537" class="Symbol">→</a> <a id="1539" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a><a id="1540" class="Symbol">)</a> <a id="1542" class="Symbol">→</a> <a id="1544" class="Symbol">(</a><a id="1545" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1547" class="Symbol">→</a> <a id="1549" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a><a id="1550" class="Symbol">)</a>
<a id="1552" href="elementary-number-theory.fibonacci-sequence.html#1514" class="Function">shift-two</a> <a id="1562" href="elementary-number-theory.fibonacci-sequence.html#1562" class="Bound">m</a> <a id="1564" href="elementary-number-theory.fibonacci-sequence.html#1564" class="Bound">n</a> <a id="1566" href="elementary-number-theory.fibonacci-sequence.html#1566" class="Bound">f</a> <a id="1568" class="Symbol">=</a> <a id="1570" href="elementary-number-theory.fibonacci-sequence.html#1441" class="Function">shift-one</a> <a id="1580" href="elementary-number-theory.fibonacci-sequence.html#1562" class="Bound">m</a> <a id="1582" class="Symbol">(</a><a id="1583" href="elementary-number-theory.fibonacci-sequence.html#1441" class="Function">shift-one</a> <a id="1593" href="elementary-number-theory.fibonacci-sequence.html#1564" class="Bound">n</a> <a id="1595" href="elementary-number-theory.fibonacci-sequence.html#1566" class="Bound">f</a><a id="1596" class="Symbol">)</a>

<a id="Fibo-zero-ℕ"></a><a id="1599" href="elementary-number-theory.fibonacci-sequence.html#1599" class="Function">Fibo-zero-ℕ</a> <a id="1611" class="Symbol">:</a> <a id="1613" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1615" class="Symbol">→</a> <a id="1617" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a>
<a id="1619" href="elementary-number-theory.fibonacci-sequence.html#1599" class="Function">Fibo-zero-ℕ</a> <a id="1631" class="Symbol">=</a> <a id="1633" href="elementary-number-theory.fibonacci-sequence.html#1514" class="Function">shift-two</a> <a id="1643" class="Number">0</a> <a id="1645" class="Number">1</a> <a id="1647" class="Symbol">(λ</a> <a id="1650" href="elementary-number-theory.fibonacci-sequence.html#1650" class="Bound">x</a> <a id="1652" class="Symbol">→</a> <a id="1654" class="Number">0</a><a id="1655" class="Symbol">)</a>

<a id="Fibo-succ-ℕ"></a><a id="1658" href="elementary-number-theory.fibonacci-sequence.html#1658" class="Function">Fibo-succ-ℕ</a> <a id="1670" class="Symbol">:</a> <a id="1672" class="Symbol">(</a><a id="1673" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1675" class="Symbol">→</a> <a id="1677" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a><a id="1678" class="Symbol">)</a> <a id="1680" class="Symbol">→</a> <a id="1682" class="Symbol">(</a><a id="1683" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1685" class="Symbol">→</a> <a id="1687" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a><a id="1688" class="Symbol">)</a>
<a id="1690" href="elementary-number-theory.fibonacci-sequence.html#1658" class="Function">Fibo-succ-ℕ</a> <a id="1702" href="elementary-number-theory.fibonacci-sequence.html#1702" class="Bound">f</a> <a id="1704" class="Symbol">=</a> <a id="1706" href="elementary-number-theory.fibonacci-sequence.html#1514" class="Function">shift-two</a> <a id="1716" class="Symbol">(</a><a id="1717" href="elementary-number-theory.fibonacci-sequence.html#1702" class="Bound">f</a> <a id="1719" class="Number">1</a><a id="1720" class="Symbol">)</a> <a id="1722" class="Symbol">(</a><a id="1723" href="elementary-number-theory.addition-natural-numbers.html#988" class="Function">add-ℕ</a> <a id="1729" class="Symbol">(</a><a id="1730" href="elementary-number-theory.fibonacci-sequence.html#1702" class="Bound">f</a> <a id="1732" class="Number">1</a><a id="1733" class="Symbol">)</a> <a id="1735" class="Symbol">(</a><a id="1736" href="elementary-number-theory.fibonacci-sequence.html#1702" class="Bound">f</a> <a id="1738" class="Number">0</a><a id="1739" class="Symbol">))</a> <a id="1742" class="Symbol">(λ</a> <a id="1745" href="elementary-number-theory.fibonacci-sequence.html#1745" class="Bound">x</a> <a id="1747" class="Symbol">→</a> <a id="1749" class="Number">0</a><a id="1750" class="Symbol">)</a>

<a id="Fibo-function"></a><a id="1753" href="elementary-number-theory.fibonacci-sequence.html#1753" class="Function">Fibo-function</a> <a id="1767" class="Symbol">:</a> <a id="1769" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1771" class="Symbol">→</a> <a id="1773" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1775" class="Symbol">→</a> <a id="1777" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a>
<a id="1779" href="elementary-number-theory.fibonacci-sequence.html#1753" class="Function">Fibo-function</a> <a id="1793" class="Symbol">=</a>
  <a id="1797" href="elementary-number-theory.natural-numbers.html#2497" class="Function">ind-ℕ</a>
    <a id="1807" class="Symbol">(</a> <a id="1809" href="elementary-number-theory.fibonacci-sequence.html#1599" class="Function">Fibo-zero-ℕ</a><a id="1820" class="Symbol">)</a>
    <a id="1826" class="Symbol">(</a> <a id="1828" class="Symbol">λ</a> <a id="1830" href="elementary-number-theory.fibonacci-sequence.html#1830" class="Bound">n</a> <a id="1832" class="Symbol">→</a> <a id="1834" href="elementary-number-theory.fibonacci-sequence.html#1658" class="Function">Fibo-succ-ℕ</a><a id="1845" class="Symbol">)</a>

<a id="Fibo"></a><a id="1848" href="elementary-number-theory.fibonacci-sequence.html#1848" class="Function">Fibo</a> <a id="1853" class="Symbol">:</a> <a id="1855" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a> <a id="1857" class="Symbol">→</a> <a id="1859" href="elementary-number-theory.natural-numbers.html#1444" class="Datatype">ℕ</a>
<a id="1861" href="elementary-number-theory.fibonacci-sequence.html#1848" class="Function">Fibo</a> <a id="1866" href="elementary-number-theory.fibonacci-sequence.html#1866" class="Bound">k</a> <a id="1868" class="Symbol">=</a> <a id="1870" href="elementary-number-theory.fibonacci-sequence.html#1753" class="Function">Fibo-function</a> <a id="1884" href="elementary-number-theory.fibonacci-sequence.html#1866" class="Bound">k</a> <a id="1886" class="Number">0</a>
</pre>